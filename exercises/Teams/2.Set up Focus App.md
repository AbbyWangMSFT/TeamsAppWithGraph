# Module 2 - Set up Focus App  
In this module you will set up the Focus app inside in Teams channel created at Module 1  

## Hook up ngrok with Focus app code  
1. Run the FocusFrontEnd solution in workshop-code-base folder  
2. Download the [ngrok software](https://ngrok.com/download) if you haven't  
3. Start ngrok to create an externally addressable URL for the Focus app:  
Run, for example, ngrok http 60792 --host-header=localhost:60790, replace the port number as needed.  
![ngrok screenshot](imgs/ngrok.PNG "ngrok screenshot")

## Register the Focus App in Azure  
1. Login into the [Azure portal](https://ms.portal.azure.com) with admin account  
2. Register Focus App  
![Azure Active Diretory](imgs/aad.PNG "Azure Active Diretory")
![App registrations menu](imgs/AppReg.PNG "App registrations menu")
![New app registration button](imgs/newAppReg.PNG "New app registration button")
Please select the multitenant option and add the redirect url https://****.ngrok.io/WorkFlow/EndAuth, replace the star with the real nogrok url generated at last step  
![App registration detail](imgs/RegAppDetail.PNG "App registration detail")
3. Add the API permissions for this app
![View API permissions](imgs/AppApiPermissions.PNG "View API permissions")
![Add API permissions](imgs/AddPermissions.PNG "Add API permissions")
![Add Graph API permissions](imgs/GraphApiPermissions.PNG "Add Graph API permissions")
![Add delegated permissions](imgs/delegatedPermissions.PNG "Add delegated permissions")  
Make sure to select all belong permissions  
![Required permissions](imgs/RequiredGraphPermissions.PNG  "Required permissions")  
Grant the admin consent  
![Admind consent](imgs/adminConsent.PNG  "Admind consent")  